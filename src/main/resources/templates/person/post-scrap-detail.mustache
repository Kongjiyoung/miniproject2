{{> layout/header}}
<!--<div class="container justify-content-center mt-4 mb-5">-->
<div class="container d-flex">
    <div class="border hs_content_box w-100 mx-2 b-5 rounded shadow">
        <div class="px-5 pt-5 pb-2">
        </div>
        <div class="px-5">
            <input style="display: none" id="companyId">
            <div class="d-flex justify-content-start align-items-center">
                <div class="col">
                    <h3 style="font-weight: bold">{{scrap.post.title}}</h3>
                </div>
                <form action="/person/scrap/{{scrap.id}}/detail/delete" method="post">
                    <div class="d-flex justify-content-end">
                        <button class="btn btn-outline-success" type="submit">취소하기</button>
                    </div>
                </form>
            </div>
            <hr class="d-inline-flex w-100">
            <hr class="d-inline-flex w-100">
            <form id="applyForm" class="row d-flex justify-content-end g-3 align-items-center"
                  action="/person/scrap/{{scrap.id}}/detail/apply" method="post">
                <div class="col-auto">
                    <select class="form-select form-select-sm" aria-label="Default select example" id="resumeChoice"
                            name="resumeChoice">
                        <option selected>이력서를 선택해 주세요</option>
                        {{#resumeList}}
                            <option value="{{id}}">{{title}}</option>
                        {{/resumeList}}
                    </select>
                </div>
                <div class="col-auto">
                    <button id="applyButton" class="btn btn-outline-success btn-sm" type="submit"><i
                            class="far fa-paper-plane"></i>
                    </button>
                </div>
            </form>
            <script>
                $('#applyButton').click(function () {
                    let resumeId = $('#resumeChoice').val();

                    if (!resumeId || resumeId === "이력서를 선택해 주세요") {
                        alert("이력서를 선택해 주세요.");
                        return false;
                    }

                    // 서버로 중복 지원 여부 확인 요청
                    $.ajax({
                        type: "GET",
                        url: "/checkApplyStatus",
                        data: {resumeId: resumeId},
                        success: function (response) {
                            if (response.applied) {
                                // 중복 지원이 감지되면 알림을 표시하고 이력서 선택을 다시 가능하게 합니다.
                                alert('해당 이력서로 이미 지원한 채용공고입니다.');
                                // 이력서 선택을 초기화합니다.
                                $('#resumeChoice').val('이력서를 선택해 주세요');
                                return false;
                            } else {
                                // 중복 지원이 아니라면 폼을 서버로 제출합니다.
                                $('#applyForm').submit();
                            }
                        },
                        error: function (xhr, status, error) {
                            console.error(error);
                        }
                    });
                });
            </script>
            <div class="pt-2 mt-3">
                <div class="border border-tertiary px-3 py-3 pt-3 d-inline-flex ms-2 me-3 mb-3 w-100">
                    <div>
                        <img src="/images/{{scrap.post.profile}}" alt="이력서 사진" style="width: 100%; height: 226px;">
                    </div>
                    <table class="mx-4">
                        <tr>
                            <td>경력</td>
                            <td>{{scrap.post.career}}</td>
                        </tr>
                        <tr>
                            <td>최소 연봉</td>
                            <td>{{scrap.post.pay}}</td>
                        </tr>
                        <tr>
                            <td>마감일</td>
                            <td>{{scrap.post.deadline}}</td>
                        </tr>
                        <tr>
                            <td>회사명</td>
                            <td><a href="#"
                                   style=" color: black; font-weight: bold;">{{scrap.post.user.companyName}}</a>
                            </td>
                            <!-- TODO: 가능하다면 이 회사의 진행 중인 채용 공고 모음을 만들어보자 -->
                        </tr>
                    </table>
                </div>
                <div class="mt-5">
                </div>
                <div class="mt-5 task">
                    <h4>주요 업무</h4>
                    <div>{{scrap.post.task}}</div>
                </div>
                <div class="mt-5 working-time">
                    <h4>근무 시간</h4>
                    <div>{{scrap.post.workStartTime}} ~ {{scrap.post.workEndTime}}</div>
                </div>
                <div class="mt-5 working-time">
                    <h4>근무 지역</h4>
                    <div>{{scrap.post.workingArea}}</div>
                </div>
                <div class="mt-5 working-time">
                    <h4>혜택 및 복지</h4>
                    <div>{{scrap.post.workCondition}}</div>
                </div>
                <div class="mt-5 qualification">
                    <h4>필요 스킬</h4>
                    <div class="d-flex justify-content-start">
                        <div class="row row-cols-auto gap-3 justify-content-start my-3" style="width: 70%;">
                            {{#scrap.post.skillList}}
                                <div class="btn btn-outline-primary mx-3 disabled">{{skill}}</div>
                            {{/scrap.post.skillList}}
                        </div>
                    </div>
                </div>
            </div>
            <div class="d-flex justify-content-center mt-3">
                <!--                <a href="/company/post/detail/{id}/updateForm" class="btn btn-outline-success mb-3"-->
                <!--                        style="width: 100%">수정하기-->
                <!--                </a> -->

            </div>
        </div>
    </div>
    <!-- list-group( 오른쪽 바로가기) 시작 -->
    <div class="list-group mx-2">
        <a href="/person/info" class="list-group-item shadow " style="width: 150px;">회원정보관리</a>
        <a href="/person/resumes" class="list-group-item shadow">이력서관리</a>
        <a href="/person/scraps" class="list-group-item hs_list_effect shadow">스크랩한 공고</a>
        <a href="/person/offers" class="list-group-item shadow">받은 제안</a>
        <a href="/person/applies" class="list-group-item shadow">지원 현황</a>
    </div>
    <!-- list-group( 오른쪽 바로가기) 끝 -->
</div>


{{> layout/footer}}